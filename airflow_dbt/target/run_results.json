{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2024-07-11T19:19:40.332912Z", "invocation_id": "d6b7eac7-0961-4f6c-a268-2ea554d8f334", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:34.954429Z", "completed_at": "2024-07-11T19:19:34.974184Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:34.975184Z", "completed_at": "2024-07-11T19:19:34.975184Z"}], "thread_id": "Thread-4", "execution_time": 0.024473905563354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_customer", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`customer`\n\n),\n\nrenamed as (\n\n    select\n        customerid,\n        personid,\n        storeid,\n        territoryid,\n        accountnumber,\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_customer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:34.963942Z", "completed_at": "2024-07-11T19:19:34.974184Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:34.976774Z", "completed_at": "2024-07-11T19:19:34.976774Z"}], "thread_id": "Thread-1", "execution_time": 0.02734827995300293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_address", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`address`\n\n),\n\nrenamed as (\n\n    select\n        addressid,\n        addressline1,\n        addressline2,\n        city,\n        stateprovinceid,\n        postalcode,\n        spatiallocation\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_address`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:34.968177Z", "completed_at": "2024-07-11T19:19:34.975184Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:34.977823Z", "completed_at": "2024-07-11T19:19:34.977823Z"}], "thread_id": "Thread-3", "execution_time": 0.027396440505981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_countryregion", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`countryregion`\n\n),\n\nrenamed as (\n\n    select\n        countryregioncode,\n        countryregionname\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_countryregion`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:34.970184Z", "completed_at": "2024-07-11T19:19:34.976774Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:34.979828Z", "completed_at": "2024-07-11T19:19:34.979828Z"}], "thread_id": "Thread-2", "execution_time": 0.030401945114135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_businessentityaddress", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`businessentityaddress`\n\n),\nrenamed as (\n\n    select\n        addresstypeid,\n        businessentityid,\n        addressid\n    from source\n)\n    \nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_businessentityaddress`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.013495Z", "completed_at": "2024-07-11T19:19:35.045834Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.047840Z", "completed_at": "2024-07-11T19:19:35.047840Z"}], "thread_id": "Thread-1", "execution_time": 0.06701159477233887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_person", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`person`\n\n),\n\nrenamed as (\n\n    select\n        businessentityid,\n        persontype,\n        namestyle,\n        title,\n        firstname,\n        middlename,\n        lastname,\n        suffix,\n        emailpromotion,\n        rowguid,\n        birthdate,\n        maritalstatus,\n        gender,\n        totalchildren,\n        numberchildrenathome,\n        houseownerflag,\n        numbercarsowned,\n        datefirstpurchase,\n        commutedistance,\n        education,\n        occupation\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_person`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.016514Z", "completed_at": "2024-07-11T19:19:35.046796Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.049838Z", "completed_at": "2024-07-11T19:19:35.049838Z"}], "thread_id": "Thread-3", "execution_time": 0.06701040267944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_product", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`product`\n\n),\n\nrenamed as (\n\n    select\n        productid,\n        productname,\n        productnumber,\n        makeflag,\n        finishedgoodsflag,\n        color,\n        safetystocklevel,\n        reorderpoint,\n        \n\n  CAST(REPLACE(standardcost, ',', '.') AS FLOAT64)\n\n AS standardcost,\n        \n\n  CAST(REPLACE(listprice, ',', '.') AS FLOAT64)\n\n AS listprice,\n        size,\n        sizeunitmeasurecode,\n        weightunitmeasurecode,\n        weight,\n        daystomanufacture,\n        productline,\n        class,\n        style,\n        productsubcategoryid,\n        productmodelid,\n        sellstartdate,\n        sellenddate,\n        discontinueddate\n        \n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_product`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.021557Z", "completed_at": "2024-07-11T19:19:35.048840Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.050868Z", "completed_at": "2024-07-11T19:19:35.050868Z"}], "thread_id": "Thread-2", "execution_time": 0.06703853607177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_productcategory", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`productcategory`\n\n),\n\nrenamed as (\n\n    select\n        productcategoryid,\n        productcategory\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_productcategory`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.055860Z", "completed_at": "2024-07-11T19:19:35.067836Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.068836Z", "completed_at": "2024-07-11T19:19:35.068836Z"}], "thread_id": "Thread-1", "execution_time": 0.01599740982055664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_productsubcategory", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`productsubcategory`\n\n),\n\nrenamed as (\n\n    select\n        productsubcategoryid,\n        productcategoryid,\n        productsubcategory\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_productsubcategory`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.060267Z", "completed_at": "2024-07-11T19:19:35.067836Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.069836Z", "completed_at": "2024-07-11T19:19:35.069836Z"}], "thread_id": "Thread-3", "execution_time": 0.015998363494873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_salesorderdetail", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`salesorderdetail`\n\n),\n\nrenamed as (\n\n    select\n        salesorderid,\n        salesorderdetailid,\n        carriertrackingnumber,\n        orderqty,\n        productid,\n        specialofferid,\n        \n\n  CAST(REPLACE(unitprice, ',', '.') AS FLOAT64)\n\n AS unitprice,\n        \n\n  CAST(REPLACE(unitpricediscount, ',', '.') AS FLOAT64)\n\n AS unitpricediscount,\n        linetotal\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_salesorderdetail`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.063286Z", "completed_at": "2024-07-11T19:19:35.070838Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.071835Z", "completed_at": "2024-07-11T19:19:35.071835Z"}], "thread_id": "Thread-2", "execution_time": 0.017997264862060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_salesorderheader", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`salesorderheader`\n\n),\n\nrenamed as (\n\n    select\n        salesorderid,\n        revisionnumber,\n        TIMESTAMP(orderdate) AS orderdate,\n        TIMESTAMP(duedate) AS duedate,\n        TIMESTAMP(shipdate) AS shipdate,\n        status,\n        onlineorderflag,\n        salesordernumber,\n        purchaseordernumber,\n        accountnumber,\n        customerid,\n        salespersonid,\n        territoryid,\n        billtoaddressid,\n        shiptoaddressid,\n        shipmethodid,\n        creditcardid,\n        creditcardapprovalcode,\n        currencyrateid,\n        \n\n  CAST(REPLACE(subtotal, ',', '.') AS FLOAT64)\n\n AS subtotal,\n        \n\n  CAST(REPLACE(taxamt, ',', '.') AS FLOAT64)\n\n AS taxamt,\n        \n\n  CAST(REPLACE(freight, ',', '.') AS FLOAT64)\n\n AS freight,\n        \n\n  CAST(REPLACE(totaldue, ',', '.') AS FLOAT64)\n\n AS totaldue,\n        comment\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_salesorderheader`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.077383Z", "completed_at": "2024-07-11T19:19:35.089073Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.090056Z", "completed_at": "2024-07-11T19:19:35.090056Z"}], "thread_id": "Thread-1", "execution_time": 0.01719522476196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_salesorderheadersalesreason", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`salesorderheadersalesreason`\n\n),\n\nrenamed as (\n\n    select\n        salesorderid,\n        salesreasonid\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_salesorderheadersalesreason`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.080895Z", "completed_at": "2024-07-11T19:19:35.089073Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.091081Z", "completed_at": "2024-07-11T19:19:35.091081Z"}], "thread_id": "Thread-3", "execution_time": 0.017244815826416016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_salesreason", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`salesreason`\n\n),\n\nrenamed as (\n\n    select\n        salesreasonid,\n        salesreason,\n        reasontype\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_salesreason`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.083897Z", "completed_at": "2024-07-11T19:19:35.092057Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.094056Z", "completed_at": "2024-07-11T19:19:35.094056Z"}], "thread_id": "Thread-2", "execution_time": 0.01721048355102539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_salesterritory", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`salesterritory`\n\n),\n\nrenamed as (\n\n    select\n        territoryid,\n        salesterritoryname,\n        countryregioncode,\n        `group`,\n        \n\n  CAST(REPLACE(salesytd, ',', '.') AS FLOAT64)\n\n AS salesytd,\n        \n\n  CAST(REPLACE(saleslastyear, ',', '.') AS FLOAT64)\n\n AS saleslastyear,\n        \n\n  CAST(REPLACE(costytd, ',', '.') AS FLOAT64)\n\n AS costytd,\n        \n\n  CAST(REPLACE(costlastyear, ',', '.') AS FLOAT64)\n\n AS costlastyear,\n        \n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_salesterritory`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.097702Z", "completed_at": "2024-07-11T19:19:35.103703Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.115919Z", "completed_at": "2024-07-11T19:19:35.115919Z"}], "thread_id": "Thread-1", "execution_time": 0.020843982696533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_specialoffer", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`specialoffer`\n\n),\n\nrenamed as (\n\n    select\n        specialofferid,\n        description,\n        \n\n  CAST(REPLACE(discountpct, ',', '.') AS FLOAT64)\n\n AS salesytd,\n        type,\n        category,\n        startdate,\n        enddate,\n        minqty,\n        maxqty\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_specialoffer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.100720Z", "completed_at": "2024-07-11T19:19:35.115395Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.116841Z", "completed_at": "2024-07-11T19:19:35.116841Z"}], "thread_id": "Thread-3", "execution_time": 0.021143674850463867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_stateprovince", "compiled": true, "compiled_code": "with source as (\n\n    select * from `elt-project-427017`.`sales_db`.`stateprovince`\n\n),\n\nrenamed as (\n\n    select\n        stateprovinceid,\n        stateprovincecode,\n        countryregioncode,\n        isonlystateprovinceflag,\n        statprovincename,\n        territoryid\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_stateprovince`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.105211Z", "completed_at": "2024-07-11T19:19:35.117970Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.118980Z", "completed_at": "2024-07-11T19:19:35.118980Z"}], "thread_id": "Thread-2", "execution_time": 0.02127814292907715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.not_null_stg_customer_customerid.6418d30796", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customerid\nfrom `elt-project-427017`.`sales_db_staging`.`stg_customer`\nwhere customerid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.123976Z", "completed_at": "2024-07-11T19:19:35.137962Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.138941Z", "completed_at": "2024-07-11T19:19:35.138941Z"}], "thread_id": "Thread-1", "execution_time": 0.01897144317626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.unique_stg_customer_customerid.c2a326da40", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select customerid as unique_field\n  from `elt-project-427017`.`sales_db_staging`.`stg_customer`\n  where customerid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.129901Z", "completed_at": "2024-07-11T19:19:35.138941Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.140943Z", "completed_at": "2024-07-11T19:19:35.140943Z"}], "thread_id": "Thread-3", "execution_time": 0.019974231719970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.not_null_stg_address_addressid.b2c3ff1261", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect addressid\nfrom `elt-project-427017`.`sales_db_staging`.`stg_address`\nwhere addressid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.133885Z", "completed_at": "2024-07-11T19:19:35.139942Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.142943Z", "completed_at": "2024-07-11T19:19:35.142943Z"}], "thread_id": "Thread-2", "execution_time": 0.01994943618774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.unique_stg_address_addressid.5faede3af1", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select addressid as unique_field\n  from `elt-project-427017`.`sales_db_staging`.`stg_address`\n  where addressid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.146066Z", "completed_at": "2024-07-11T19:19:35.163196Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.165177Z", "completed_at": "2024-07-11T19:19:35.165177Z"}], "thread_id": "Thread-1", "execution_time": 0.023234128952026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.unique_stg_countryregion_countryregioncode.69920521ee", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select countryregioncode as unique_field\n  from `elt-project-427017`.`sales_db_staging`.`stg_countryregion`\n  where countryregioncode is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.151156Z", "completed_at": "2024-07-11T19:19:35.164197Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.165901Z", "completed_at": "2024-07-11T19:19:35.165901Z"}], "thread_id": "Thread-3", "execution_time": 0.02093362808227539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.accepted_values_stg_productcategory_productcategory__Bikes__Components__Clothing__Accessories.6b5165f5ae", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        productcategory as value_field,\n        count(*) as n_records\n\n    from `elt-project-427017`.`sales_db_staging`.`stg_productcategory`\n    group by productcategory\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Bikes','Components','Clothing','Accessories'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.159175Z", "completed_at": "2024-07-11T19:19:35.166895Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.168036Z", "completed_at": "2024-07-11T19:19:35.168036Z"}], "thread_id": "Thread-2", "execution_time": 0.018879413604736328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.not_null_stg_productcategory_productcategoryid.8121bfa386", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect productcategoryid\nfrom `elt-project-427017`.`sales_db_staging`.`stg_productcategory`\nwhere productcategoryid is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.172034Z", "completed_at": "2024-07-11T19:19:35.188783Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.197082Z", "completed_at": "2024-07-11T19:19:35.197082Z"}], "thread_id": "Thread-1", "execution_time": 0.028021812438964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.unique_stg_productcategory_productcategoryid.40f41ade89", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select productcategoryid as unique_field\n  from `elt-project-427017`.`sales_db_staging`.`stg_productcategory`\n  where productcategoryid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.176116Z", "completed_at": "2024-07-11T19:19:35.198099Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.199983Z", "completed_at": "2024-07-11T19:19:35.199983Z"}], "thread_id": "Thread-3", "execution_time": 0.029948711395263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.dimProduct", "compiled": true, "compiled_code": "select\n    to_hex(md5(cast(coalesce(cast(stg_product.productid as string), '_dbt_utils_surrogate_key_null_') as string))) as product_key,\n    stg_product.productid,\n    stg_product.productname as product_name,\n    stg_product.productnumber,\n    stg_product.color,\n    stg_product.daystomanufacture,\n\tstg_product.safetystocklevel,\n    stg_product.standardcost,\n    stg_productsubcategory.productsubcategory as product_subcategory_name,\n    stg_productcategory.productcategory as product_category_name,\n    stg_product.sellstartdate,\n    stg_product.sellenddate\nfrom  `elt-project-427017`.`sales_db_staging`.`stg_product`\nleft join  `elt-project-427017`.`sales_db_staging`.`stg_productsubcategory` on stg_product.productsubcategoryid = stg_productsubcategory.productsubcategoryid\nleft join  `elt-project-427017`.`sales_db_staging`.`stg_productcategory` on stg_productsubcategory.productcategoryid = stg_productcategory.productcategoryid", "relation_name": "`elt-project-427017`.`sales_db_mart`.`dimProduct`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.189697Z", "completed_at": "2024-07-11T19:19:35.198986Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.200982Z", "completed_at": "2024-07-11T19:19:35.200982Z"}], "thread_id": "Thread-2", "execution_time": 0.029946088790893555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.fctSales", "compiled": true, "compiled_code": "select\n    to_hex(md5(cast(coalesce(cast(stg_salesorderdetail.salesorderid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(salesorderdetailid as string), '_dbt_utils_surrogate_key_null_') as string))) as sales_key,\n    to_hex(md5(cast(coalesce(cast(productid as string), '_dbt_utils_surrogate_key_null_') as string))) as product_key,\n    to_hex(md5(cast(coalesce(cast(customerid as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,\n    to_hex(md5(cast(coalesce(cast(specialofferid as string), '_dbt_utils_surrogate_key_null_') as string))) as special_offer_key,\n    to_hex(md5(cast(coalesce(cast(stg_salesorderheadersalesreason.salesreasonid as string), '_dbt_utils_surrogate_key_null_') as string))) as sales_reason_key,\n    to_hex(md5(cast(coalesce(cast(orderdate as string), '_dbt_utils_surrogate_key_null_') as string))) as order_date_key,\n    to_hex(md5(cast(coalesce(cast(shipdate as string), '_dbt_utils_surrogate_key_null_') as string))) as ship_date_key,\n    to_hex(md5(cast(coalesce(cast(duedate as string), '_dbt_utils_surrogate_key_null_') as string))) as due_date_key,\n    to_hex(md5(cast(coalesce(cast(territoryid as string), '_dbt_utils_surrogate_key_null_') as string))) as territory_key,\n    orderdate,\n    onlineorderflag,\n    stg_salesorderdetail.specialofferid as specialoffer,\n    stg_salesorderheadersalesreason.salesreasonid as salesreason,\n    stg_salesorderdetail.unitpricediscount as unitpricediscount,\n    stg_salesorderdetail.unitprice,\n    stg_salesorderdetail.orderqty,\n    stg_salesorderdetail.linetotal as salesamount,\n    case when stg_salesorderdetail.unitpricediscount > 0\n        then stg_salesorderdetail.linetotal * stg_salesorderdetail.unitpricediscount \n        else stg_salesorderdetail.linetotal\n        end as totaldiscount,\n    stg_salesorderheader.taxamt \nfrom `elt-project-427017`.`sales_db_staging`.`stg_salesorderdetail`\ninner join  `elt-project-427017`.`sales_db_staging`.`stg_salesorderheader` on stg_salesorderdetail.salesorderid = stg_salesorderheader.salesorderid\nleft join `elt-project-427017`.`sales_db_staging`.`stg_salesorderheadersalesreason` on stg_salesorderheader.salesorderid = stg_salesorderheadersalesreason.salesorderid", "relation_name": "`elt-project-427017`.`sales_db_mart`.`fctSales`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.204981Z", "completed_at": "2024-07-11T19:19:35.210480Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.217633Z", "completed_at": "2024-07-11T19:19:35.217633Z"}], "thread_id": "Thread-1", "execution_time": 0.01665043830871582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.dimSalesReason", "compiled": true, "compiled_code": "select \n     to_hex(md5(cast(coalesce(cast(stg_salesreason.salesreasonid as string), '_dbt_utils_surrogate_key_null_') as string))) as sales_reason_key,\n    salesreasonid,\n    salesreason,\n    reasontype\n\nfrom `elt-project-427017`.`sales_db_staging`.`stg_salesreason`", "relation_name": "`elt-project-427017`.`sales_db_mart`.`dimSalesReason`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.210480Z", "completed_at": "2024-07-11T19:19:35.218637Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.219640Z", "completed_at": "2024-07-11T19:19:35.219640Z"}], "thread_id": "Thread-3", "execution_time": 0.016657352447509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.dimTerritory", "compiled": true, "compiled_code": "select \n     to_hex(md5(cast(coalesce(cast(stg_salesterritory.territoryid as string), '_dbt_utils_surrogate_key_null_') as string))) as territory_key,\n    territoryid, \n    salesterritoryname, \n    \"Group\" as territory_group, \n    countryregioncode, \n    costytd,  \n    salesytd, \n    costlastyear,\n    saleslastyear\nfrom `elt-project-427017`.`sales_db_staging`.`stg_salesterritory`", "relation_name": "`elt-project-427017`.`sales_db_mart`.`dimTerritory`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.213496Z", "completed_at": "2024-07-11T19:19:35.220638Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.222638Z", "completed_at": "2024-07-11T19:19:35.222638Z"}], "thread_id": "Thread-2", "execution_time": 0.014137983322143555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.dimOrderSpecialOffer", "compiled": true, "compiled_code": "select\n    to_hex(md5(cast(coalesce(cast(stg_specialoffer.specialofferid as string), '_dbt_utils_surrogate_key_null_') as string))) as special_offer_key,\n    specialofferid,\n    description,\n    salesytd,\n    type,\n    category,\n    startDate,\n    enddate,\n    minqty,\n    maxqty\nfrom `elt-project-427017`.`sales_db_staging`.`stg_specialoffer`", "relation_name": "`elt-project-427017`.`sales_db_mart`.`dimOrderSpecialOffer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.225142Z", "completed_at": "2024-07-11T19:19:35.238516Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.243516Z", "completed_at": "2024-07-11T19:19:35.243516Z"}], "thread_id": "Thread-1", "execution_time": 0.021877527236938477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.dimCustomer", "compiled": true, "compiled_code": "select\n    to_hex(md5(cast(coalesce(cast(stg_customer.customerid as string), '_dbt_utils_surrogate_key_null_') as string))) as customer_key,\n    stg_customer.customerid,\n    stg_person.businessentityid as personbusinessentityid,\n    stg_person.title,\n    stg_person.firstname || ' '|| lastname as fullname,\n    stg_person.houseownerflag, \n    stg_person.occupation, \n    stg_person.maritalstatus, \n    stg_person.commutedistance, \n    stg_person.education, \n    stg_person.gender,\n    stg_person.numbercarsowned, \n    stg_person.totalchildren, \n    stg_person.birthdate, \n    stg_person.datefirstpurchase,\n    stg_countryregion.countryregionname as country,\n    stg_address.city,\n    stg_stateprovince.statprovincename as state,\n    stg_address.postalcode,\n    stg_address.addressline1,\n    stg_address.addressline2\nfrom `elt-project-427017`.`sales_db_staging`.`stg_customer`\nleft join `elt-project-427017`.`sales_db_staging`.`stg_person` on stg_customer.personid = stg_person.businessentityid\nleft join `elt-project-427017`.`sales_db_staging`.`stg_businessentityaddress` on stg_businessentityaddress.businessentityid = stg_person.businessentityid\nleft join `elt-project-427017`.`sales_db_staging`.`stg_address` on stg_address.addressid = stg_businessentityaddress.addressid\nleft join `elt-project-427017`.`sales_db_staging`.`stg_stateprovince` on stg_stateprovince.stateprovinceid = stg_address.stateprovinceid\nleft join `elt-project-427017`.`sales_db_staging`.`stg_countryregion` on stg_countryregion.countryregioncode = stg_stateprovince.countryregioncode\nwhere persontype = 'IN'\nand addresstypeid = 2", "relation_name": "`elt-project-427017`.`sales_db_mart`.`dimCustomer`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.230501Z", "completed_at": "2024-07-11T19:19:35.242532Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.243516Z", "completed_at": "2024-07-11T19:19:35.243516Z"}], "thread_id": "Thread-3", "execution_time": 0.01987767219543457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.relationships_stg_address_stateprovinceid__stateprovinceid__ref_stg_stateprovince_.6b71cf8ab0", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select stateprovinceid as from_field\n    from `elt-project-427017`.`sales_db_staging`.`stg_address`\n    where stateprovinceid is not null\n),\n\nparent as (\n    select stateprovinceid as to_field\n    from `elt-project-427017`.`sales_db_staging`.`stg_stateprovince`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.238516Z", "completed_at": "2024-07-11T19:19:35.246024Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.247593Z", "completed_at": "2024-07-11T19:19:35.247593Z"}], "thread_id": "Thread-2", "execution_time": 0.018077373504638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.not_null_dimProduct_product_key.795453a445", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_key\nfrom `elt-project-427017`.`sales_db_mart`.`dimProduct`\nwhere product_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.249525Z", "completed_at": "2024-07-11T19:19:35.257650Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.263693Z", "completed_at": "2024-07-11T19:19:35.263693Z"}], "thread_id": "Thread-1", "execution_time": 0.016754865646362305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.unique_dimProduct_product_key.3429424d75", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_key as unique_field\n  from `elt-project-427017`.`sales_db_mart`.`dimProduct`\n  where product_key is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.253541Z", "completed_at": "2024-07-11T19:19:35.262651Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.263693Z", "completed_at": "2024-07-11T19:19:35.263693Z"}], "thread_id": "Thread-3", "execution_time": 0.016100406646728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.not_null_fctSales_sales_key.7104171205", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sales_key\nfrom `elt-project-427017`.`sales_db_mart`.`fctSales`\nwhere sales_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.258651Z", "completed_at": "2024-07-11T19:19:35.266206Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.267277Z", "completed_at": "2024-07-11T19:19:35.267277Z"}], "thread_id": "Thread-2", "execution_time": 0.013736486434936523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.unique_fctSales_sales_key.3b0e1c2fd8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select sales_key as unique_field\n  from `elt-project-427017`.`sales_db_mart`.`fctSales`\n  where sales_key is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.270098Z", "completed_at": "2024-07-11T19:19:35.329188Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.330094Z", "completed_at": "2024-07-11T19:19:35.330094Z"}], "thread_id": "Thread-1", "execution_time": 0.06300497055053711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.not_null_dimTerritory_territory_key.042315bc71", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect territory_key\nfrom `elt-project-427017`.`sales_db_mart`.`dimTerritory`\nwhere territory_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.326081Z", "completed_at": "2024-07-11T19:19:35.331093Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.336143Z", "completed_at": "2024-07-11T19:19:35.336143Z"}], "thread_id": "Thread-3", "execution_time": 0.06793951988220215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.unique_dimTerritory_territory_key.9a24ec39da", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select territory_key as unique_field\n  from `elt-project-427017`.`sales_db_mart`.`dimTerritory`\n  where territory_key is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.332091Z", "completed_at": "2024-07-11T19:19:35.337116Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.338149Z", "completed_at": "2024-07-11T19:19:35.338149Z"}], "thread_id": "Thread-2", "execution_time": 0.013115882873535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.not_null_dimCustomer_customer_key.809567d2c6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_key\nfrom `elt-project-427017`.`sales_db_mart`.`dimCustomer`\nwhere customer_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:35.340149Z", "completed_at": "2024-07-11T19:19:35.343149Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:35.344149Z", "completed_at": "2024-07-11T19:19:35.344149Z"}], "thread_id": "Thread-1", "execution_time": 0.007033586502075195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.unique_dimCustomer_customer_key.a6efdbf53e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select customer_key as unique_field\n  from `elt-project-427017`.`sales_db_mart`.`dimCustomer`\n  where customer_key is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:34.985853Z", "completed_at": "2024-07-11T19:19:37.876117Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:37.877121Z", "completed_at": "2024-07-11T19:19:37.877121Z"}], "thread_id": "Thread-4", "execution_time": 2.8962936401367188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.stg_date", "compiled": true, "compiled_code": "with date_dim as (\n\n    \n    \nwith base_dates as (\n    \n    with date_spine as\n(\n\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1460\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n        datetime_add(\n            cast( cast('2011-01-01' as datetime ) as datetime),\n        interval (row_number() over (order by 1) - 1) day\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2014-12-31' as datetime )\n\n)\n\nselect * from filtered\n\n\n\n)\nselect\n    cast(d.date_day as timestamp) as date_day\nfrom\n    date_spine d\n\n\n),\ndates_with_prior_year_dates as (\n\n    select\n        cast(d.date_day as date) as date_day,\n        cast(\n\n        datetime_add(\n            cast( d.date_day as datetime),\n        interval -1 year\n        )\n\n as date) as prior_year_date_day,\n        cast(\n\n        datetime_add(\n            cast( d.date_day as datetime),\n        interval -364 day\n        )\n\n as date) as prior_year_over_year_date_day\n    from\n    \tbase_dates d\n\n)\nselect\n    d.date_day,\n    cast(\n\n        datetime_add(\n            cast( d.date_day as datetime),\n        interval -1 day\n        )\n\n as date) as prior_date_day,\n    cast(\n\n        datetime_add(\n            cast( d.date_day as datetime),\n        interval 1 day\n        )\n\n as date) as next_date_day,\n    d.prior_year_date_day as prior_year_date_day,\n    d.prior_year_over_year_date_day,\n    extract(dayofweek from d.date_day) as day_of_week,\n    case\n        -- Shift start of week from Sunday (1) to Monday (2)\n        when extract(dayofweek from d.date_day) = 1 then 7\n        else extract(dayofweek from d.date_day) - 1\n    end as day_of_week_iso,\n    format_date('%A', cast(d.date_day as date)) as day_of_week_name,\n    format_date('%a', cast(d.date_day as date)) as day_of_week_name_short,\n    extract(day from d.date_day) as day_of_month,\n    extract(dayofyear from d.date_day) as day_of_year,\n\n    cast(timestamp_trunc(\n        cast(d.date_day as timestamp),\n        week\n    ) as date) as week_start_date,\n    cast(\n        \n\n        datetime_add(\n            cast( \n\n        datetime_add(\n            cast( timestamp_trunc(\n        cast(d.date_day as timestamp),\n        week\n    ) as datetime),\n        interval 1 week\n        )\n\n as datetime),\n        interval -1 day\n        )\n\n\n        as date) as week_end_date,\n    cast(timestamp_trunc(\n        cast(d.prior_year_over_year_date_day as timestamp),\n        week\n    ) as date) as prior_year_week_start_date,\n    cast(\n        \n\n        datetime_add(\n            cast( \n\n        datetime_add(\n            cast( timestamp_trunc(\n        cast(d.prior_year_over_year_date_day as timestamp),\n        week\n    ) as datetime),\n        interval 1 week\n        )\n\n as datetime),\n        interval -1 day\n        )\n\n\n        as date) as prior_year_week_end_date,\n    cast(extract(week from d.date_day) as INT64) as week_of_year,\n\n    cast(timestamp_trunc(\n        cast(d.date_day as timestamp),\n        isoweek\n    ) as date) as iso_week_start_date,\n    cast(\n\n        datetime_add(\n            cast( cast(timestamp_trunc(\n        cast(d.date_day as timestamp),\n        isoweek\n    ) as date) as datetime),\n        interval 6 day\n        )\n\n as date) as iso_week_end_date,\n    cast(timestamp_trunc(\n        cast(d.prior_year_over_year_date_day as timestamp),\n        isoweek\n    ) as date) as prior_year_iso_week_start_date,\n    cast(\n\n        datetime_add(\n            cast( cast(timestamp_trunc(\n        cast(d.prior_year_over_year_date_day as timestamp),\n        isoweek\n    ) as date) as datetime),\n        interval 6 day\n        )\n\n as date) as prior_year_iso_week_end_date,\n    cast(extract(isoweek from d.date_day) as INT64) as iso_week_of_year,\n\n    cast(extract(week from d.prior_year_over_year_date_day) as INT64) as prior_year_week_of_year,\n    cast(extract(isoweek from d.prior_year_over_year_date_day) as INT64) as prior_year_iso_week_of_year,\n\n    cast(extract(month from d.date_day) as INT64) as month_of_year,\n    format_date('%B', cast(d.date_day as date))  as month_name,\n    format_date('%b', cast(d.date_day as date))  as month_name_short,\n\n    cast(timestamp_trunc(\n        cast(d.date_day as timestamp),\n        month\n    ) as date) as month_start_date,\n    cast(cast(\n        \n\n        datetime_add(\n            cast( \n\n        datetime_add(\n            cast( timestamp_trunc(\n        cast(d.date_day as timestamp),\n        month\n    ) as datetime),\n        interval 1 month\n        )\n\n as datetime),\n        interval -1 day\n        )\n\n\n        as date) as date) as month_end_date,\n\n    cast(timestamp_trunc(\n        cast(d.prior_year_date_day as timestamp),\n        month\n    ) as date) as prior_year_month_start_date,\n    cast(cast(\n        \n\n        datetime_add(\n            cast( \n\n        datetime_add(\n            cast( timestamp_trunc(\n        cast(d.prior_year_date_day as timestamp),\n        month\n    ) as datetime),\n        interval 1 month\n        )\n\n as datetime),\n        interval -1 day\n        )\n\n\n        as date) as date) as prior_year_month_end_date,\n\n    cast(extract(quarter from d.date_day) as INT64) as quarter_of_year,\n    cast(timestamp_trunc(\n        cast(d.date_day as timestamp),\n        quarter\n    ) as date) as quarter_start_date,\n    cast(cast(\n        \n\n        datetime_add(\n            cast( \n\n        datetime_add(\n            cast( timestamp_trunc(\n        cast(d.date_day as timestamp),\n        quarter\n    ) as datetime),\n        interval 1 quarter\n        )\n\n as datetime),\n        interval -1 day\n        )\n\n\n        as date) as date) as quarter_end_date,\n\n    cast(extract(year from d.date_day) as INT64) as year_number,\n    cast(timestamp_trunc(\n        cast(d.date_day as timestamp),\n        year\n    ) as date) as year_start_date,\n    cast(cast(\n        \n\n        datetime_add(\n            cast( \n\n        datetime_add(\n            cast( timestamp_trunc(\n        cast(d.date_day as timestamp),\n        year\n    ) as datetime),\n        interval 1 year\n        )\n\n as datetime),\n        interval -1 day\n        )\n\n\n        as date) as date) as year_end_date\nfrom\n    dates_with_prior_year_dates d\norder by 1\n\n\n\n)\nselect \n    *\nfrom date_dim", "relation_name": "`elt-project-427017`.`sales_db_staging`.`stg_date`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:37.880120Z", "completed_at": "2024-07-11T19:19:40.312287Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:40.313286Z", "completed_at": "2024-07-11T19:19:40.313286Z"}], "thread_id": "Thread-3", "execution_time": 2.4341650009155273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.airflow_dbt.dimDate", "compiled": true, "compiled_code": "-- CTE to create a date dimension from the stg_date table\nwith date_dimension as (\n    select * from `elt-project-427017`.`sales_db_staging`.`stg_date`\n),\n\n-- CTE to generate a full date range from start_date to end_date using dbt_date.get_base_dates macro\nfull_dt as (\n    \n    with date_spine as\n(\n\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1460\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n        datetime_add(\n            cast( cast('2011-01-01' as datetime ) as datetime),\n        interval (row_number() over (order by 1) - 1) day\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2014-12-31' as datetime )\n\n)\n\nselect * from filtered\n\n\n\n)\nselect\n    cast(d.date_day as timestamp) as date_day\nfrom\n    date_spine d\n\n\n),\n\n-- CTE to join the date dimension with the full date range and perform various timezone conversions\nfull_dt_tr as (\nselect\n    d.*,\n    f.date_day as fulldt,\n    timestamp(datetime(f.date_day, 'America/New_York')) as dulldtz,\n    timestamp(datetime(f.date_day, 'America/New_York')) as dulldtzt,\n    timestamp(datetime(f.date_day, 'America/New_York')) as test,\n    --f.date_day  AT TIME ZONE 'PST' AS \"direct_pst\",\n    TIMESTAMP(f.date_day) AS direct_dts,\n    TIMESTAMP(f.date_day) AS ts_utc\nfrom\n    date_dimension d\n    left join full_dt f on d.date_day = cast(f.date_day as date)\n)\n\n-- Final select statement to generate the date_key and select all columns from full_dt_tr\nselect \n    to_hex(md5(cast(coalesce(cast(direct_dts as string), '_dbt_utils_surrogate_key_null_') as string))) as date_key,\n    *\nFrom full_dt_tr", "relation_name": "`elt-project-427017`.`sales_db_mart`.`dimDate`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:40.316794Z", "completed_at": "2024-07-11T19:19:40.327038Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:40.327038Z", "completed_at": "2024-07-11T19:19:40.327038Z"}], "thread_id": "Thread-1", "execution_time": 0.012752294540405273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.not_null_dimDate_date_key.7f3f1b9224", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_key\nfrom `elt-project-427017`.`sales_db_mart`.`dimDate`\nwhere date_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T19:19:40.321795Z", "completed_at": "2024-07-11T19:19:40.327895Z"}, {"name": "execute", "started_at": "2024-07-11T19:19:40.328912Z", "completed_at": "2024-07-11T19:19:40.328912Z"}], "thread_id": "Thread-4", "execution_time": 0.012118339538574219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.airflow_dbt.unique_dimDate_date_key.d6fbddac20", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select date_key as unique_field\n  from `elt-project-427017`.`sales_db_mart`.`dimDate`\n  where date_key is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 6.284849166870117, "args": {"empty_catalog": false, "compile": true, "version_check": true, "log_path": "C:\\Users\\destr\\dbt_learn\\airflow_dbt\\logs", "use_colors": true, "profiles_dir": "C:\\Users\\destr\\dbt_learn\\airflow_dbt", "static_parser": true, "vars": {}, "log_format_file": "debug", "cache_selected_only": false, "require_resource_names_without_spaces": false, "macro_debugging": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "show_resource_report": false, "send_anonymous_usage_stats": true, "strict_mode": false, "select": [], "introspect": true, "print": true, "write_json": true, "exclude": [], "use_colors_file": true, "populate_cache": true, "project_dir": "C:\\Users\\destr\\dbt_learn\\airflow_dbt", "indirect_selection": "eager", "invocation_command": "dbt docs generate", "warn_error_options": {"include": [], "exclude": []}, "which": "generate", "defer": false, "printer_width": 80, "log_file_max_bytes": 10485760, "log_level": "info", "quiet": false, "enable_legacy_logger": false, "favor_state": false, "log_level_file": "debug", "static": false, "partial_parse": true, "source_freshness_run_project_hooks": false, "partial_parse_file_diff": true}}